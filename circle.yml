dependencies:
  pre:
    - echo y | android update sdk -u -a -t addon-google_apis-google-22
    - echo y | android update sdk -u -a -t sys-img-armeabi-v7a-android-22
    - echo n | android create avd -n testing -f -t android-22 -b google_apis/armeabi-v7a
test:
  override:
    - emulator -avd testing -no-audio -no-window -no-boot-anim:
        background: true
        parallel: true
    - circle-android wait-for-boot
    - ./gradlew assembleDebug
    - ./gradlew assembleRelease
    - sleep 60
    - (ADB_INSTALL_TIMEOUT=10 ./gradlew connectedAndroidTest --stacktrace):
        timeout: 360
    - cp -r app/build/outputs $CIRCLE_ARTIFACTS
    - cp app/build/outputs/androidTest-results/connected/*.xml $CIRCLE_TEST_REPORTS

